!function(a,b){"function"==typeof define&&define.amd?define([],function(){return b()}):"object"==typeof exports?module.exports=b():a.Macy=b()}(this,function(){"use strict";var a=function(b){var e,c={},d=1,f=function(b){for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&("[object Object]"===Object.prototype.toString.call(b[e])?c[e]=a(c[e],b[e]):c[e]=b[e])};for(f(arguments[0]),d=1;d<arguments.length;d++){f(arguments[d])}return c},b={};b.VERSION="1.1.2",b.settings={};var e,f,c={columns:3,margin:2,trueOrder:!0,waitForImages:!1},d={options:{}},g=function(){var b,a=window.innerWidth;for(var c in d.options.breakAt)if(a<c){b=d.options.breakAt[c];break}return b||(b=d.options.columns),b},h=function(a){a=void 0===a||a;var c,b=g();return a?1===b?"100%":(c=(b-1)*d.options.margin/b,"calc("+100/b+"% - "+c+"px)"):100/b},i=function(){var a=h();w(d.elements,function(b,c){c.style.width=a,c.style.position="absolute"})},j=function(a){var e,b=g(),c=0;return 1===++a?0:(e=(d.options.margin-(b-1)*d.options.margin/b)*(a-1),c+=h(!1)*(a-1),"calc("+c+"% + "+e+"px)")},k=function(a,b,c){var f,e=0;if(0===a)return 0;for(var g=0;g<a;g++)f=parseInt(p(d.elements[c[g]],"height").replace("px",""),10),e+=isNaN(f)?0:f+d.options.margin;return e},l=function(a){var b=0,c=[],e=[],f=[];w(d.elements,function(d){b++,b>a&&(b=1,c.push(e),e=[]),e.push(d)}),c.push(e);for(var g=0,h=c.length;g<h;g++)for(var i=c[g],j=0,k=i.length;j<k;j++)f[j]=void 0===f[j]?[]:f[j],f[j].push(i[j]);d.rows=f,n(!1)},m=function(a){for(var b=d.elements,c=[],e=[],f=0;f<a;f++)c[f]=[];for(var g=0;g<b.length;g++)e.push(g);for(var h=0,i=e.length;h<i;h++){var j=o(c);c[j]=void 0===c[j]?[]:c[j],c[j].push(e[h])}d.rows=c,n(!0)},n=function(a){a=a||!1;for(var b=d.elements,c=d.rows,e=0,f=c.length;e<f;e++)for(var g=a?t(c[e]):c[e],h=0,i=g.length;h<i;h++){var l,m;l=j(e),m=k(h,e,g,a),b[g[h]].style.top=m+"px",b[g[h]].style.left=l}},o=function(a){for(var c,e,f,g,b=0,h=0,i=a.length;h<i;h++){for(var j=0;j<a[h].length;j++)g=parseInt(p(d.elements[a[h][j]],"height").replace("px",""),10),b+=isNaN(g)?0:g;f=e,e=void 0===e?b:e>b?b:e,(void 0===f||f>e)&&(c=h),b=0}return c},p=function(a,b){return window.getComputedStyle(a,null).getPropertyValue(b)},q=function(){for(var a=d.rows,b=0,c=0,e=0,f=a.length;e<f;e++){for(var g=0;g<a[e].length;g++)c+=parseInt(p(d.elements[a[e][g]],"height").replace("px",""),10),c+=0!==g?d.options.margin:0;b=b<c?c:b,c=0}return b},r=function(){var a=g();return 1===a?(d.container.style.height="auto",void w(d.elements,function(a,b){b.removeAttribute("style")})):(i(),d.elements=d.container.children,d.options.trueOrder?(l(a),void s()):(m(a),void s()))},s=function(){d.container.style.height=q()+"px"},t=function(a){for(var b=a,c=b.length-1,d=0;d<c;d++)for(var e=0;e<c;e++)if(b[e]>b[e+1]){var f=b[e];b[e]=b[e+1],b[e+1]=f}return b},u=function(a){return document.querySelector(a)},v=function(a){for(var b=d.container.querySelectorAll(a),c=[],e=b.length-1;e>=0;e--)null!==b[e].parentNode&&c.unshift(b[e]);return c},w=function(a,b){for(var c=0,d=a.length;c<d;c++)b(c,a[c])},x=function(a,b){a=a||!1,b=b||!1,"function"==typeof a&&a(),f>=e&&"function"==typeof b&&b()},y=function(){w(d.container.children,function(a,b){b.removeAttribute("style")}),d.container.removeAttribute("style"),window.removeEventListener("resize",r)},z=function(a,b){var c=v("img");e=c.length-1,f=0,w(c,function(c,d){if(d.complete)return f++,void x(a,b);d.addEventListener("load",function(){f++,x(a,b)}),d.addEventListener("error",function(){e--,x(a,b)})})};return b.init=function(b){if(b.container&&(d.container=u(b.container),d.container)){if(delete b.container,d.options=a(c,b),window.addEventListener("resize",r),d.container.style.position="relative",d.elements=d.container.children,!d.options.waitForImages)return r(),void z(function(){r()});z(null,function(){r()})}},b.recalculate=r,b.onImageLoad=z,b.remove=y,b});
